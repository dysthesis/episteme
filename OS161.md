---
type: Topic note
tags:
  - COMP3231
created: 2024-02-29 15:00
---
# Components

- [[OS161]] itself
- [[System161]], the simulated machine that [[OS161]] runs on.
- Development tools required to compile and debug code on [[System161]] (`gcc`, `gdb`, etc.)

# Code reading
**From:** [Assignment 1 - Code Reading](https://cgi.cse.unsw.edu.au/~cs3231/24T1/assignments/asst1/#code-reading)

## Thread questions

### What happens to a thread when it exits (*i.e.* calls `thread_exit()`)? What about when it sleeps?

`thread_exit()` has the following implementation in [[OS161]]:

```C
/*
 * Cause the current thread to exit.
 *
 * The parts of the thread structure we don't actually need to run
 * should be cleaned up right away. The rest has to wait until
 * thread_destroy is called from exorcise().
 *
 * Does not return.
 */
void
thread_exit(void)
{
	struct thread *cur;
	
	cur = curthread;
	
	/*
	 * Detach from our process. You might need to move this action
	 * around, depending on how your wait/exit works.
	 */
	proc_remthread(cur);
	
	/* Make sure we *are* detached (move this only if you're sure!) */
	KASSERT(cur->t_proc == NULL);
	
	/* Check the stack guard band. */
	thread_checkstack(cur);
	
	/* Interrupts off on this processor */
        splhigh();
	thread_switch(S_ZOMBIE, NULL, NULL);
	panic("braaaaaaaiiiiiiiiiiinssssss\n");
}
```

---
# References
